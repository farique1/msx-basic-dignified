10 ' Refactored with MSX Basic Dignified
20 ' CHANGE GRAPH KIT
30 ' v1.2.5
40 ' Bug fixes
50 ' Edit uncompressed graphics on MSX binary files on disk
60 ' Copyright (1984 - 2019) - Fred Rique (farique)
70 ' https://github.com/farique1/Change-Graph-Kit
80 '
90 SCREEN 0:COLOR 15,1,1:WIDTH 40:KEY OFF
100 DEFINT A-Z
110 DEF FN ZZ(X)=ABS(X MOD 16+16) MOD 16
120 ZY=1:ZX=15:ZW=2:ZV=6
130 ZU=0:ZT=0:ZS=0:ZR=0
140 ZW$="" ' leave blank to enable file request
150 IF ZW$<>"" THEN GOTO 230
160 LOCATE 12,8:PRINT "Insert game disk"
170 LOCATE 11,10:PRINT "and press any key."
180 A$=INKEY$:IF A$="" GOTO 180
190 CLS
200 PRINT "Pick a Game":PRINT "without extension"
210 PRINT:PRINT:PRINT:FILES "*.bin"
220 PRINT:PRINT:PRINT:LINE INPUT "> ";ZW$
230 ' {inicializacao}
240 CLS:SCREEN 1:WIDTH 32
250 VPOKE 6914,0:VPOKE 6918,1:VPOKE 6922,2:VPOKE 6926,3:VPOKE 6930,2 'Assign sprites
260 LOCATE 10,11:PRINT "INITIALIZING"
270 OPEN ZW$+".bin" AS #1 LEN=1
280 FIELD #1,1 AS ZZ$
290 GET #1,3:ZY$=ZZ$:GET #1,2:ZX$=ZZ$:ZQ=(ASC(ZY$)*256+ASC(ZX$))-65536!
300 GET #1,5:ZY$=ZZ$:GET #1,4:ZX$=ZZ$:ZP=(ASC(ZY$)*256+ASC(ZX$))-65536!
310 ZE=ZP-ZQ
320 ZD=&H1:ZC=8:ZB=800:ZU=1
330 ZA=ZD:YZ=16:YY=23:YX=8
340 GOSUB 1330
350 FOR F=0 TO 7:READ A:VPOKE 1856+F,A:NEXT
360 FOR F=0 TO 7:READ A:VPOKE 1864+F,A:NEXT
370 FOR F=0 TO 7:READ A:VPOKE 1872+F,A:NEXT
380 FOR F=0 TO 23:READ A:VPOKE 8+F,A:NEXT
390 FOR F=0 TO 7:READ A:VPOKE 1824+F,A:NEXT
400 FOR F=0 TO 7:READ A:VPOKE 128+F,A:NEXT
410 FOR F=0 TO 7:READ A:VPOKE 248+F,A:NEXT
420 FOR F=0 TO 31:READ A:VPOKE 14336+F,A:NEXT
430 ' {search_screen}
440 CLS
450 LOCATE 0,0:PRINT "        CHANGE GRAPH KIT        "
460 LOCATE 1,2:PRINT "XWWWWWWWWWWY"
470 LOCATE 1,3:PRINT "VÄäîû®≤º∆–⁄V"
480 LOCATE 1,4:PRINT "VÅãïü©≥Ω«—€V"
490 LOCATE 1,5:PRINT "VÇåñ†™¥æ»“‹V"
500 LOCATE 1,6:PRINT "VÉçó°´µø…”›V"
510 LOCATE 1,7:PRINT "VÑéò¢¨∂¿ ‘ﬁV"
520 LOCATE 1,8:PRINT "VÖèô£≠∑¡À’ﬂV"
530 LOCATE 1,9:PRINT "VÜêö§Æ∏¬Ã÷‡V"
540 LOCATE 1,10:PRINT "Váëõ•Øπ√Õ◊·V"
550 LOCATE 1,11:PRINT "Vàíú¶∞∫ƒŒÿ‚V"
560 LOCATE 1,12:PRINT "Vâìùß±ª≈œŸ„V"
570 LOCATE 1,13:PRINT "ZWWWWWWWWWW["
580 LOCATE 3,15:PRINT "Srt# End#"
590 LOCATE 1,17:PRINT "C"
600 LOCATE 3,17:PRINT STRING$(4-LEN(HEX$(ZA)),"0")+HEX$(ZA)
610 LOCATE 8,17:PRINT STRING$(4-LEN(HEX$(ZA+( YX-1))),"0")+HEX$(ZA+( YX-1))
620 LOCATE 1,19:PRINT "R"
630 LOCATE 3,19:PRINT STRING$(4-LEN(HEX$(ZD)),"0")+HEX$(ZD)
640 LOCATE 8,19:PRINT STRING$(4-LEN(HEX$(ZD+799)),"0")+HEX$(ZD+799)
650 LOCATE 1,21:PRINT "G"
660 LOCATE 3,21:PRINT STRING$(4-LEN(HEX$(1)),"0")+HEX$(1)
670 LOCATE 8,21:PRINT STRING$(4-LEN(HEX$(ZE)),"0")+HEX$(ZE)
680 LOCATE 13,2:PRINT "XWWWWWWWRWWWWWWWWY"
690 ' Cm = Cursor Movement   Rm = Region Movement
700 LOCATE 13,3:PRINT "VCm #  "+RIGHT$(STR$(ZC),1)+"VEditing V"
710 LOCATE 13,4:PRINT "VRm #"+RIGHT$(HEX$(ZB),3)+"V"+ZW$+STRING$(8-LEN(ZW$)," ")+"V"
720 LOCATE 13,5:PRINT "ZWWWWWWWQWWWWWWWW["
730 ' {keys_page_start}
740 ON ZR GOTO 820
750 LOCATE 13,7:PRINT "VÍVMove VPVSave   "
760 LOCATE 13,9:PRINT "VÈVStep VDVSize   "
770 LOCATE 13,11:PRINT "VËVEdit VRVRefresh"
780 LOCATE 13,13:PRINT "VFVFreeze/Unfreeze"
790 LOCATE 13,15:PRINT "VEVExplode/Ovrview"
800 LOCATE 13,17:PRINT "                  "
810 GOTO 890
820 ' {keys_page_2}
830 LOCATE 13,7:PRINT "VNVNew            "
840 LOCATE 13,9:PRINT "VQVPrev VWVNext   "
850 LOCATE 13,11:PRINT "VAVP 4x VSVN 4x   "
860 LOCATE 13,13:PRINT "VZVSrtVXVMidVCVEnd"
870 LOCATE 13,15:PRINT "V1-8VChange Colors"
880 LOCATE 13,17:PRINT "                  "
890 ' {keys_page_end}
900 LOCATE 13,19:PRINT "      VVVMore Keys" ' VHVHelp
910 LOCATE 13,21:PRINT "ABBBBBBBBBBBBBBBBC"
920 GOSUB 1800:REM if haltScan=1 then locate 2,2:print "WWFREEZEWW"
930 IF ZT=1 THEN LOCATE 2,13:PRINT "WOverviewW"
940 YW=YY+(YX-2):YV=0
950 IF YY+(YX-2)>101 THEN YV=8:YW=23+(YY+(YX-2))-103
960 IF YZ+YV>95 THEN YW=200
970 VPOKE 6912,YY-1:VPOKE 6913,YZ
980 VPOKE 6916,YW+1:VPOKE 6917,YV+YZ
990 VPOKE 6920,167:VPOKE 6921,142*ZD/ZE+105
1000 VPOKE 6928,167:VPOKE 6929,(142*ZD/ZE)+105+(100800!/ZE)
1010 IF ZS=1 THEN ZS=0:GOSUB 1630
1020 ' {read_keyboard_main}
1030 A$=INKEY$
1040 IF A$="1" THEN ZY=ZY-1:GOSUB 1330
1050 IF A$="2" THEN ZY=ZY+1:GOSUB 1330
1060 IF A$="3" THEN ZX=ZX-1:GOSUB 1330
1070 IF A$="4" THEN ZX=ZX+1:GOSUB 1330
1080 IF A$="5" THEN ZW=ZW-1:GOSUB 1330
1090 IF A$="6" THEN ZW=ZW+1:GOSUB 1330
1100 IF A$="7" THEN ZV=ZV-1:GOSUB 1330
1110 IF A$="8" THEN ZV=ZV+1:GOSUB 1330
1120 IF A$=CHR$(&H1C) AND YZ+8<95 THEN YZ=YZ+8:ZA=ZA+80:GOSUB 1440
1130 IF A$=CHR$(&H1D) AND YZ-8>15 THEN YZ=YZ-8:ZA=ZA-80:GOSUB 1440
1140 IF A$=CHR$(&H1E) AND YY-ZC>22 THEN YY=YY-ZC:ZA=ZA-ZC:GOSUB 1440
1150 IF A$=CHR$(&H1F) AND YY+ZC<103 THEN YY=YY+ZC:ZA=ZA+ZC:GOSUB 1440
1160 IF A$="P" THEN SCREEN 0:WIDTH 40:CLOSE:PRINT ZW$+" closed":PRINT:PRINT:PRINT:PRINT "ENTER to open another file ";:LINE INPUT A$:RUN
1170 IF A$=" " THEN GOSUB 1840
1180 IF A$="D" THEN GOSUB 1540
1190 IF A$=CHR$(13) THEN GOTO 1890
1200 IF A$="E" THEN GOTO 2890
1210 IF A$="R" THEN ZO=0:GOSUB 1750
1220 IF A$="F" THEN ZO=0:ZU=ABS(ZU-1):IF ZU=1 THEN GOSUB 1800:ELSE:GOSUB 1750
1230 IF A$="Q" THEN ZO=ZA-ZD:ZD=ZD-ZB:GOSUB 1630
1240 IF A$="W" THEN ZO=ZA-ZD:ZD=ZD+ZB:GOSUB 1630
1250 IF A$="A" THEN ZO=ZA-ZD:ZD=ZD-ZB*4:GOSUB 1630
1260 IF A$="S" THEN ZO=ZA-ZD:ZD=ZD+ZB*4:GOSUB 1630
1270 IF A$="Z" THEN ZO=ZA-ZD:ZD=&H1:GOSUB 1630
1280 IF A$="X" THEN ZO=ZA-ZD:ZD=(ZE/2)-400:GOSUB 1630
1290 IF A$="C" THEN ZO=ZA-ZD:ZD=ZE-800:GOSUB 1630
1300 IF A$="N" THEN RUN
1310 IF A$="V" THEN ZR=ABS(ZR-1):GOTO 730
1320 GOTO 1020
1330 ' {set_color}
1340 ZY=FN ZZ(ZY)
1350 ZX=FN ZZ(ZX)
1360 ZW=FN ZZ(ZW)
1370 ZV=FN ZZ(ZV)
1380 COLOR ZX,ZY,ZY
1390 VPOKE 8194,ZV*16+ZY:VPOKE 8195,ZV*16+ZY 'Borders character color, blocks of 8 chars
1400 VPOKE 8192,ZV*16+ZW 'Region character colors, blocks of 8 chars
1410 VPOKE 6915,ZX:VPOKE 6919,ZX:VPOKE 6923,ZX:VPOKE 6927,ZX:VPOKE 6931,ZX 'Sprite color
1420 FOR F=8208 TO 8220:VPOKE F,ZW*16+ZY:NEXT 'Scan area character colors, blocks of 8 chars
1430 RETURN
1440 ' {move_scan_sprite}
1450 YW=YY+( YX-2):YV=0
1460 IF YY+( YX-2)>101 THEN YV=8:YW=23+(YY+( YX-2))-103
1470 IF YZ+YV>95 THEN YW=200
1480 VPOKE 6912,YY-1:VPOKE 6913,YZ
1490 VPOKE 6916,YW+1:VPOKE 6917,YZ+YV
1500 LOCATE 3,17:PRINT STRING$(4-LEN(HEX$(ZA)),"0")+HEX$(ZA)
1510 LOCATE 8,17:PRINT STRING$(4-LEN(HEX$(ZA+( YX-1))),"0")+HEX$(ZA+( YX-1))
1520 RETURN
1530 RETURN
1540 ' {change_sprite_size}
1550 IF YX=8 THEN YX=32 ELSE YX=8
1560 YW=YY+(YX-2):YV=0
1570 IF YY+(YX-2)>101 THEN YV=8:YW=23+(YY+(YX-2))-103
1580 IF YZ+YV>95 THEN YW=200
1590 VPOKE 6916,YW+1:VPOKE 6917,YZ+YV
1600 LOCATE 3,17:PRINT STRING$(4-LEN(HEX$(ZA)),"0")+HEX$(ZA)
1610 LOCATE 8,17:PRINT STRING$(4-LEN(HEX$(ZA+( YX-1))),"0")+HEX$(ZA+( YX-1))
1620 RETURN
1630 ' {update_memory_position}
1640 IF ZD<&H1 THEN ZD=&H1
1650 IF ZD+800>ZE THEN ZD=ZE-800
1660 ZA=ZD+ZO
1670 VPOKE 6920,167:VPOKE 6921,142*ZD/ZE+105
1680 VPOKE 6928,167:VPOKE 6929,(142*ZD/ZE)+105+(100800!/ZE)
1690 LOCATE 3,17:PRINT STRING$(4-LEN(HEX$(ZA)),"0")+HEX$(ZA)
1700 LOCATE 8,17:PRINT STRING$(4-LEN(HEX$(ZA+7)),"0")+HEX$(ZA+7)
1710 LOCATE 3,19:PRINT STRING$(4-LEN(HEX$(ZD)),"0")+HEX$(ZD)
1720 LOCATE 8,19:PRINT STRING$(4-LEN(HEX$(ZD+799)),"0")+HEX$(ZD+799)
1730 IF ZU=0 THEN 1750
1740 RETURN
1750 ' {scan}
1760 ZT=0
1770 LOCATE 2,2:PRINT "WWWSCANWWW"
1780 LOCATE 2,13:PRINT "WVÈVStopWW"
1790 FOR F=ZD TO ZD+799:VPOKE 1024-ZD+F,0:GET #1,F:A$=ZZ$:VPOKE 1024-ZD+F,ASC(A$):IF INKEY$=" " THEN 1800 ELSE NEXT
1800 ' {end_scan}
1810 IF ZU=1 THEN LOCATE 2,2:PRINT "WWFREEZEWW" ELSE LOCATE 2,2:PRINT "WWWWWWWWWW"
1820 LOCATE 2,13:PRINT "WWWWWWWWWW"
1830 RETURN
1840 ' {change_movement_step}
1850 IF ZC=8 THEN ZC=1 ELSE ZC=8
1860 IF ZB=800 THEN ZB=400 ELSE ZB=800
1870 LOCATE 20,3:PRINT RIGHT$(HEX$(ZC),1):LOCATE 18,4:PRINT RIGHT$(HEX$(ZB),3)
1880 RETURN
1890 ' {edit_screen}
1900 CLS
1910 VPOKE 6920,200:VPOKE 6928,200
1920 LOCATE 0,0:PRINT "        CHANGE GRAPH KIT        "
1930 LOCATE 1,2:PRINT "XWWWWWWWWWWY"
1940 LOCATE 1,3:PRINT "VÄäîû®≤º∆–⁄V"
1950 LOCATE 1,4:PRINT "VÅãïü©≥Ω«—€V"
1960 LOCATE 1,5:PRINT "VÇåñ†™¥æ»“‹V"
1970 LOCATE 1,6:PRINT "VÉçó°´µø…”›V"
1980 LOCATE 1,7:PRINT "VÑéò¢¨∂¿ ‘ﬁV"
1990 LOCATE 1,8:PRINT "VÖèô£≠∑¡À’ﬂV"
2000 LOCATE 1,9:PRINT "VÜêö§Æ∏¬Ã÷‡V"
2010 LOCATE 1,10:PRINT "Váëõ•Øπ√Õ◊·V"
2020 LOCATE 1,11:PRINT "Vàíú¶∞∫ƒŒÿ‚V"
2030 LOCATE 1,12:PRINT "Vâìùß±ª≈œŸ„V"
2040 LOCATE 1,13:PRINT "ZWWWWWWWWWW["
2050 LOCATE 3,15:PRINT "Srt# End#"
2060 LOCATE 1,17:PRINT "C"
2070 LOCATE 3,17:PRINT STRING$(4-LEN(HEX$(ZA)),"0")+HEX$(ZA)
2080 LOCATE 8,17:PRINT STRING$(4-LEN(HEX$(ZA+( YX-1))),"0")+HEX$(ZA+( YX-1))
2090 LOCATE 1,19:PRINT "R"
2100 LOCATE 3,19:PRINT STRING$(4-LEN(HEX$(ZD)),"0")+HEX$(ZD)
2110 LOCATE 8,19:PRINT STRING$(4-LEN(HEX$(ZD+799)),"0")+HEX$(ZD+799)
2120 LOCATE 1,21:PRINT "G"
2130 LOCATE 3,21:PRINT STRING$(4-LEN(HEX$(1)),"0")+HEX$(1)
2140 LOCATE 8,21:PRINT STRING$(4-LEN(HEX$(ZE)),"0")+HEX$(ZE)
2150 LOCATE 14,2:PRINT "________________"
2160 LOCATE 14,3:PRINT "________________"
2170 LOCATE 14,4:PRINT "________________"
2180 LOCATE 14,5:PRINT "________________"
2190 LOCATE 14,6:PRINT "________________"
2200 LOCATE 14,7:PRINT "________________"
2210 LOCATE 14,8:PRINT "________________"
2220 LOCATE 14,9:PRINT "________________"
2230 LOCATE 14,10:PRINT "________________"
2240 LOCATE 14,11:PRINT "________________"
2250 LOCATE 14,12:PRINT "________________"
2260 LOCATE 14,13:PRINT "________________"
2270 LOCATE 14,14:PRINT "________________"
2280 LOCATE 14,15:PRINT "________________"
2290 LOCATE 14,16:PRINT "________________"
2300 LOCATE 14,17:PRINT "________________"
2310 LOCATE 13,19:PRINT "VEVErzVRVRldVTVInv"
2320 LOCATE 13,21:PRINT "VÈVTglVPVSavVËVBck"
2330 VPOKE 6924,15:VPOKE 6925,112
2340 YU=0:YT=0:YS=0
2350 ' {fill_edit_area}
2360 YR=-1:YQ=0:YP=0
2370 IF YX=8 THEN ZN=7 ELSE ZN=15
2380 ZM=ZA+(YX-1) 'find formula to cap at gameLength to avoid next if
2390 IF ZM>ZE-1 THEN ZM=ZE-1
2400 FOR I=ZA TO ZM
2410 YR=YR+1
2420 IF YS=0 THEN GET #1,I:A$=ZZ$:ZV$=STRING$(8-LEN(BIN$(ASC(A$))),"0")+BIN$(ASC(A$)):VPOKE 1024-ZD+I,ASC(A$)
2430 IF YR>15 THEN YQ=8:YP=-16
2440 FOR F=1 TO 8
2450 IF YS=2 THEN ZL=16
2460 IF YS=0 THEN IF MID$(ZV$,F,1)="0" THEN ZL=16 ELSE ZL=228
2470 IF YS=1 THEN IF VPEEK ((YQ+13+F)+(YP+2+YR)*32+6144)=16 THEN ZL=228 ELSE ZL=16
2480 VPOKE (YQ+13+F)+(YP+2+YR)*32+6144,ZL
2490 NEXT
2500 NEXT
2510 ' {read_keyboard_edit}
2520 A$=INKEY$
2530 IF A$=CHR$(&H1C) AND YU<ZN THEN YU=YU+1:GOSUB 2640
2540 IF A$=CHR$(&H1D) AND YU>0 THEN YU=YU-1:GOSUB 2640
2550 IF A$=CHR$(&H1E) AND YT>0 THEN YT=YT-1:GOSUB 2640
2560 IF A$=CHR$(&H1F) AND YT<ZN THEN YT=YT+1:GOSUB 2640
2570 IF A$="E" THEN YS=2:GOTO 2350
2580 IF A$="R" THEN YS=0:GOTO 2350
2590 IF A$="T" THEN YS=1:GOTO 2350
2600 IF A$=" " THEN GOSUB 2670
2610 IF A$="P" THEN GOSUB 2720
2620 IF A$=CHR$(13) THEN VPOKE 6924,200:GOTO 430
2630 GOTO 2510
2640 ' {move_cursor}
2650 VPOKE 6924,15+(YT*8):VPOKE 6925,112+(YU*8)
2660 RETURN
2670 ' {change_bit}
2680 ZL=VPEEK ((YU+14)+(YT+2)*32+6144)
2690 ZL=(228+16)-ZL
2700 VPOKE (YU+14)+(YT+2)*32+6144,ZL
2710 RETURN
2720 ' {save_drawing}
2730 YR=-1:YQ=0:YP=0
2740 ZM=ZA+(YX-1) 'find formula to cap at gameLength to avoid next if
2750 IF ZM>ZE-1 THEN ZM=ZE-1
2760 FOR I=ZA TO ZM
2770 YR=YR+1
2780 IF YR>15 THEN YQ=8:YP=-16
2790 YO=128:YN=0
2800 FOR F=1 TO 8
2810 IF VPEEK ((YQ+13+F)+(YP+2+YR)*32+6144)=16 THEN G$="0" ELSE G$="1"
2820 YN=VAL(G$)*YO+YN:YO=YO/2
2830 NEXT
2840 A$=CHR$(YN)
2850 LSET ZZ$=A$:PUT #1,I
2860 VPOKE 1024-ZD+I,YN
2870 NEXT
2880 RETURN
2890 ' {explode_screen}
2900 CLS
2910 LOCATE 0,0:PRINT "        CHANGE GRAPH KIT        "
2920 LOCATE 1,2:PRINT "XWWWWWWWWWWWWWWWWWWWY"
2930 LOCATE 1,3:PRINT "VÄ ä î û ® ≤ º ∆ – ⁄V"
2940 LOCATE 1,4:PRINT "V                   V"
2950 LOCATE 1,5:PRINT "VÅ ã ï ü © ≥ Ω « — €V"
2960 LOCATE 1,6:PRINT "V                   V"
2970 LOCATE 1,7:PRINT "VÇ å ñ † ™ ¥ æ » “ ‹V"
2980 LOCATE 1,8:PRINT "V                   V"
2990 LOCATE 1,9:PRINT "VÉ ç ó ° ´ µ ø … ” ›V"
3000 LOCATE 1,10:PRINT "V                   V"
3010 LOCATE 1,11:PRINT "VÑ é ò ¢ ¨ ∂ ¿   ‘ ﬁV"
3020 LOCATE 1,12:PRINT "V                   V"
3030 LOCATE 1,13:PRINT "VÖ è ô £ ≠ ∑ ¡ À ’ ﬂV"
3040 LOCATE 1,14:PRINT "V                   V"
3050 LOCATE 1,15:PRINT "VÜ ê ö § Æ ∏ ¬ Ã ÷ ‡V"
3060 LOCATE 1,16:PRINT "V                   V"
3070 LOCATE 1,17:PRINT "Vá ë õ • Ø π √ Õ ◊ ·V"
3080 LOCATE 1,18:PRINT "V                   V"
3090 LOCATE 1,19:PRINT "Và í ú ¶ ∞ ∫ ƒ Œ ÿ ‚V"
3100 LOCATE 1,20:PRINT "V                   V"
3110 LOCATE 1,21:PRINT "Vâ ì ù ß ± ª ≈ œ Ÿ „V"
3120 LOCATE 1,22:PRINT "ZWWWWWWWWWWWWWWWWWWW["
3130 LOCATE 23,03:PRINT "VOV Ovrw"
3140 LOCATE 23,21:PRINT "VEV Back"
3150 VPOKE 6912,200:VPOKE 6916,200
3160 VPOKE 6920,200:VPOKE 6928,200
3170 IF ZT=1 THEN GOSUB 3520
3180 ' {move_overview_sprite}
3190 IF ZT=0 THEN 3250
3200 VPOKE 6912,(ZJ+1)*16+6:VPOKE 6913,(ZK+1)*16
3210 VPOKE 6916,(ZJ+1)*16+14:VPOKE 6917,(ZK+1)*16
3220 ZF=(ZJ*ZH)+(ZK*(ZH*10))
3230 LOCATE 27,13:PRINT STRING$(4-LEN(HEX$(ZF)),"0")+HEX$(ZF)
3240 LOCATE 27,15:PRINT STRING$(4-LEN(HEX$(ZF+799)),"0")+HEX$(ZF+799)
3250 ' {explode_keys}
3260 A$=INKEY$
3270 IF A$="O" THEN GOSUB 3350
3280 IF A$=CHR$(&H1C) AND ZK<9 THEN ZK=ZK+1:GOSUB 3180
3290 IF A$=CHR$(&H1D) AND ZK>0 THEN ZK=ZK-1:GOSUB 3180
3300 IF A$=CHR$(&H1F) AND ZJ<9 THEN ZJ=ZJ+1:GOSUB 3180
3310 IF A$=CHR$(&H1E) AND ZJ>0 THEN ZJ=ZJ-1:GOSUB 3180
3320 IF A$=CHR$(13) AND ZT=1 THEN ZD=(ZJ*ZH)+(ZK*(ZH*10)):ZS=1:ZA=ZD:YZ=16:YY=23:IF ZD+799>ZE THEN ZD=ZE-799:YZ=16:YY=23:ZA=ZD:GOTO 430 ELSE GOTO 430
3330 IF A$="E" THEN GOTO 430
3340 GOTO 3250
3350 ' {overview}
3360 ZI=0
3370 ZT=1
3380 ZH=(ZE/100)
3390 ZG=(9*ZH)+(9*(ZH*10))+8
3400 LOCATE 2,2:PRINT "WWWWWWWSCANWWWWWWWW"
3410 LOCATE 2,22:PRINT "WWWWWVÈVStopWWWWWWW"
3420 FOR F=1 TO ZG STEP ZH
3430 FOR I=F TO F+7
3440 VPOKE 1024+ZI,0
3450 GET #1,I
3460 A$=ZZ$
3470 VPOKE 1024+ZI,ASC(A$)
3480 IF INKEY$=" " THEN 3520
3490 ZI=ZI+1
3500 NEXT
3510 NEXT
3520 ' {end_overview}
3530 VPOKE 6912,(ZJ+1)*16+6:VPOKE 6913,(ZK+1)*16
3540 VPOKE 6916,(ZJ+1)*16+14:VPOKE 6917,(ZK+1)*16
3550 LOCATE 23,05:PRINT "VÍV Move"
3560 LOCATE 23,07:PRINT "VËV Go"
3570 LOCATE 23,11:PRINT "Region"
3580 ZF=(ZJ*ZH)+(ZK*(ZH*10))
3590 LOCATE 23,13:PRINT "St# "+STRING$(4-LEN(HEX$(ZF)),"0")+HEX$(ZF)
3600 LOCATE 23,15:PRINT "Ed# "+STRING$(4-LEN(HEX$(ZF+799)),"0")+HEX$(ZF+799)
3610 LOCATE 02,2:PRINT "WWWWWWWWWWWWWWWWWWW"
3620 LOCATE 2,22:PRINT "WWWWWWWWWWWWWWWWWWW"
3630 RETURN
3640 END
3650 ' {character_shapes}
3660 DATA 4,4,36,100,252,96,32,0
3670 DATA 0,0,219,154,82,211,0,0
3680 DATA 231,195,165,24,24,165,195,231
3690 DATA 255,128,128,128,128,128,128,255
3700 DATA 255,0,0,0,0,0,0,255
3710 DATA 255,1,1,1,1,1,1,255
3720 DATA 0,126,126,126,126,126,126,0
3730 DATA 255,129,129,129,129,129,129,255
3740 DATA 255,255,255,255,255,255,255,255
3750 ' {sprite_shapes}
3760 DATA 255,129,0,0,0,0,0,0
3770 DATA 129,255,0,0,0,0,0,0
3780 DATA 0,128,128,128,128,128,128,0
3790 DATA 255,129,129,129,129,129,129,255
3800 ' {functions_not_used}
3810 ' {create_character_block}
3820 C=127
3830 FOR X=2 TO 11
3840 FOR Y=3 TO 12
3850 C=C+1:LOCATE X,Y:PRINT:PRINT CHR$(C)
3860 NEXT
3870 NEXT
3880 END
3890 ' {character_map}
3900 FOR I=0 TO 255
3910 X=I MOD 32:Y=I\32
3920 C=I
3930 IF C<32 OR C=127 THEN C=32
3940 LOCATE X,Y:PRINT CHR$(C)
3950 LOCATE X,Y+10:PRINT CHR$(1)+CHR$(C)
3960 NEXT
3970 END
