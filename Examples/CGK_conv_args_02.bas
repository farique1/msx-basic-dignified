10 ' Refactored with MSX Basic Dignified
20 'CHANGE GRAPH KIT
30 'Find and modify uncompressed art on games
40 '
50 'Conversion arguments -gs 0 -ll 2
60 SCREEN0:COLOR15,1,1:WIDTH40:KEYOFF
70 DEFINTA-Z
80 C1=1:C2=14:C3=2:C4=6
90 PRINT"Pick a Game":PRINT"without extension"
100 ?:?:?:FILES"*.bin"
110 ?:?:?:LINEINPUT"> ";GN$
120 CLS:SCREEN1:WIDTH32
130 LOCATE10,11:PRINT"INITIALIZING"
140 REM gn$="vestron6"
150 OPENGN$+".bin"AS#1LEN=1
160 FIELD#1,1ASF$
170 GET#1,3:A$=F$:GET#1,2:B$=F$:GS=(ASC(A$)*256+ASC(B$))-65536!
180 GET#1,5:A$=F$:GET#1,4:B$=F$:GE=(ASC(A$)*256+ASC(B$))-65536!
190 GL=GE-GS
200 SI=&H1:MS=8:MR=800:HS=1
210 PS=SI:SX=16:SY=23:SS=8
220 CX=0:CY=0:TE=0
230 GOSUB1040
240 FORF=0TO7:READA:VPOKE1856+F,A:NEXT
250 FORF=0TO7:READA:VPOKE1864+F,A:NEXT
260 FORF=0TO7:READA:VPOKE1872+F,A:NEXT
270 FORF=8TO31:READA:VPOKEF,A:NEXT
280 FORF=1824TO1831:READA:VPOKEF,A:NEXT
290 FORF=128TO135:READA:VPOKEF,A:NEXT
300 FORF=248TO255:READA:VPOKEF,A:NEXT
310 FORF=0TO31:READA:VPOKE14336+F,A:NEXT
320 CLS
330 LOCATE0,0:PRINT"        CHANGE GRAPH KIT        "
340 LOCATE1,2:PRINT"XWWWWWWWWWWY"
350 LOCATE1,3:PRINT"VÄäîû®≤º∆–⁄V"
360 LOCATE1,4:PRINT"VÅãïü©≥Ω«—€V"
370 LOCATE1,5:PRINT"VÇåñ†™¥æ»“‹V"
380 LOCATE1,6:PRINT"VÉçó°´µø…”›V"
390 LOCATE1,7:PRINT"VÑéò¢¨∂¿ ‘ﬁV"
400 IFHS=1THENLOCATE4,7:PRINT"FREEZE"
410 LOCATE1,8:PRINT"VÖèô£≠∑¡À’ﬂV"
420 LOCATE1,9:PRINT"VÜêö§Æ∏¬Ã÷‡V"
430 LOCATE1,10:PRINT"Váëõ•Øπ√Õ◊·V"
440 LOCATE1,11:PRINT"Vàíú¶∞∫ƒŒÿ‚V"
450 LOCATE1,12:PRINT"Vâìùß±ª≈œŸ„V"
460 LOCATE1,13:PRINT"ZWWWWWWWWWW["
470 LOCATE3,15:PRINT"Srt# End#"
480 LOCATE1,17:PRINT"S"
490 LOCATE3,17:PRINTSTRING$(4-LEN(HEX$(PS)),"0")+HEX$(PS)
500 LOCATE8,17:PRINTSTRING$(4-LEN(HEX$(PS+7)),"0")+HEX$(PS+7)
510 LOCATE1,19:PRINT"R"
520 LOCATE3,19:PRINTSTRING$(4-LEN(HEX$(SI)),"0")+HEX$(SI)
530 LOCATE8,19:PRINTSTRING$(4-LEN(HEX$(SI+799)),"0")+HEX$(SI+799)
540 LOCATE1,21:PRINT"G"
550 LOCATE3,21:PRINTSTRING$(4-LEN(HEX$(1)),"0")+HEX$(1)
560 LOCATE8,21:PRINTSTRING$(4-LEN(HEX$(GL)),"0")+HEX$(GL)
570 LOCATE13,2:PRINT"XWWWWWWWRWWWWWWWWY"
580 LOCATE13,3:PRINT"VMS  8x"+RIGHT$(STR$(MS),1)+"VEditing V"
590 LOCATE13,4:PRINT"VMR  "+RIGHT$(STR$(MR),3)+"V"+GN$+STRING$(8-LEN(GN$)," ")+"V"
600 LOCATE13,5:PRINT"ZWWWWWWWQWWWWWWWW["
610 LOCATE13,7:PRINT"VÍVMove VPVSave"
620 LOCATE13,9:PRINT"VÈVStep VMVSize"
630 LOCATE13,11:PRINT"VËVEdit VEVExplode"
640 LOCATE13,13:PRINT"VCVTogle Refrehs"
650 LOCATE13,15:PRINT"VQVPrev VWVNext"
660 LOCATE13,17:PRINT"VZV4x   VXV4x"
670 LOCATE13,19:PRINT"VAVSrtVSVMidVDVEnd"
680 LOCATE14,21:PRINT"ABBBBBBBBBBBBBBC"
690 AY=SY+(SS-2):AX=0
700 IFSY+(SS-2)>101THENAX=8:AY=23+(SY+(SS-2))-103
710 IFSX+AX>95THENAY=200
720 VPOKE6912,SY:VPOKE6913,SX
730 VPOKE6916,AY:VPOKE6917,AX+SX
740 VPOKE6920,167:VPOKE6921,126*SI/GL+113
750 VPOKE6928,167:VPOKE6929,(126*SI/GL)+113+(100800!/GL)
760 A$=INKEY$
770 IFA$=CHR$(&H1C)ANDSX+8<95THENSX=SX+8:PS=PS+80:GOSUB1150
780 IFA$=CHR$(&H1D)ANDSX-8>15THENSX=SX-8:PS=PS-80:GOSUB1150
790 IFA$=CHR$(&H1E)ANDSY-MS>22THENSY=SY-MS:PS=PS-MS:GOSUB1150
800 IFA$=CHR$(&H1F)ANDSY+MS<103THENSY=SY+MS:PS=PS+MS:GOSUB1150
810 IFA$="E"THENGOTO2410
820 IFA$="Q"THENDP=PS-SI:SI=SI-MR:GOSUB1320
830 IFA$="W"THENDP=PS-SI:SI=SI+MR:GOSUB1320
840 IFA$="Z"THENDP=PS-SI:SI=SI-MR*4:GOSUB1320
850 IFA$="X"THENDP=PS-SI:SI=SI+MR*4:GOSUB1320
860 IFA$="A"THENDP=PS-SI:SI=&H1:GOSUB1320
870 IFA$="D"THENDP=PS-SI:SI=GL-800:GOSUB1320
880 IFA$="S"THENDP=PS-SI:SI=(GL/2)-400:GOSUB1320
890 IFA$="L"THENGOSUB1320
900 IFA$=" "THENGOSUB1440
910 IFA$="M"THENGOSUB1240
920 IFA$="P"THEN:SCREEN0:WIDTH40:CLOSE:PRINTGN$+" closed":PRINT:PRINT:PRINT:PRINT"ENTER to open another file ";:LINEINPUTA$:RUN
930 IFA$="C"THENHS=ABS(HS-1):IFHS=1THENLOCATE4,7:PRINT"FREEZE"ELSELOCATE1,7:PRINT"VÑéò¢¨∂¿ ‘ﬁV":GOSUB1320
940 IFA$=CHR$(13)ANDHS=0THENGOTO1480
950 IFA$="1"THENC1=C1-1:GOSUB1040
960 IFA$="2"THENC1=C1+1:GOSUB1040
970 IFA$="3"THENC2=C2-1:GOSUB1040
980 IFA$="4"THENC2=C2+1:GOSUB1040
990 IFA$="5"THENC3=C3-1:GOSUB1040
1000 IFA$="6"THENC3=C3+1:GOSUB1040
1010 IFA$="7"THENC1=C4-1:GOSUB1040
1020 IFA$="8"THENC1=C4+1:GOSUB1040
1030 GOTO760
1040 C1=ABS(C1MOD16+16)MOD16:' use DEF FN
1050 C2=ABS(C2MOD16+16)MOD16:' same1
1060 C3=ABS(C3MOD16+16)MOD16:' same2
1070 C4=ABS(C4MOD16+16)MOD16:' same3
1080 COLORC2,C1,C1
1090 VPOKE8194,C4*16+C1:VPOKE8195,C4*16+C1
1100 VPOKE8192,C4*16+C3
1110 VPOKE6914,0:VPOKE6918,1:VPOKE6922,2:VPOKE6926,3:VPOKE6930,2
1120 VPOKE6915,C2:VPOKE6919,C2:VPOKE6923,C2:VPOKE6927,C2
1130 FORF=8208TO8220:VPOKEF,C3*16+C1:NEXT
1140 RETURN
1150 AY=SY+(SS-2):AX=0
1160 IFSY+(SS-2)>101THENAX=8:AY=23+(SY+(SS-2))-103
1170 IFSX+AX>95THENAY=200
1180 VPOKE6912,SY:VPOKE6913,SX
1190 VPOKE6916,AY:VPOKE6917,SX+AX
1200 LOCATE3,17:PRINTSTRING$(4-LEN(HEX$(PS)),"0")+HEX$(PS):' use PRINT USING
1210 LOCATE8,17:PRINTSTRING$(4-LEN(HEX$(PS+(SS-1))),"0")+HEX$(PS+(SS-1)):' same
1220 RETURN
1230 RETURN
1240 IFSS=8THENSS=32ELSESS=8
1250 AY=SY+(SS-2):AX=0
1260 IFSY+(SS-2)>101THENAX=8:AY=23+(SY+(SS-2))-103
1270 IFSX+AX>95THENAY=200
1280 VPOKE6916,AY:VPOKE6917,SX+AX
1290 LOCATE3,17:PRINTSTRING$(4-LEN(HEX$(PS)),"0")+HEX$(PS):' use PRINT USING
1300 LOCATE8,17:PRINTSTRING$(4-LEN(HEX$(PS+(SS-1))),"0")+HEX$(PS+(SS-1)):' same
1310 RETURN
1320 IFSI<&H1THENSI=&H1
1330 IFSI+800>GLTHENSI=GL-800
1340 PS=SI+DP
1350 VPOKE6920,167:VPOKE6921,126*SI/GL+113
1360 VPOKE6928,167:VPOKE6929,(126*SI/GL)+113+(100800!/GL)
1370 LOCATE3,17:PRINTSTRING$(4-LEN(HEX$(PS)),"0")+HEX$(PS):' use PRINT USING
1380 LOCATE8,17:PRINTSTRING$(4-LEN(HEX$(PS+7)),"0")+HEX$(PS+7):' same
1390 LOCATE3,19:PRINTSTRING$(4-LEN(HEX$(SI)),"0")+HEX$(SI):' same
1400 LOCATE8,19:PRINTSTRING$(4-LEN(HEX$(SI+799)),"0")+HEX$(SI+799):' same
1410 'for f = si to si+799:vpoke 1024-si+f,peek(f) :next
1420 IFHS=0THENLOCATE5,2:PRINT"SCAN":FORF=SITOSI+799:GET#1,F:A$=F$:VPOKE1024-SI+F,ASC(A$):NEXT:LOCATE5,2:PRINT"WWWW"
1430 RETURN
1440 IFMS=8THENMS=1ELSEMS=8
1450 IFMR=800THENMR=400ELSEMR=800
1460 LOCATE20,3:PRINTRIGHT$(STR$(MS),1):LOCATE18,4:PRINTRIGHT$(STR$(MR),3)
1470 RETURN
1480 CLS
1490 VPOKE6920,200:VPOKE6928,200
1500 LOCATE0,0:PRINT"        CHANGE GRAPH KIT  read a      "
1510 LOCATE1,2:PRINT"XWWWWWWWWWWY"
1520 LOCATE1,3:PRINT"VÄäîû®≤º∆–⁄V"
1530 LOCATE1,4:PRINT"VÅãïü©≥Ω«—€V"
1540 LOCATE1,5:PRINT"VÇåñ†™¥æ»“‹V"
1550 LOCATE1,6:PRINT"VÉçó°´µø…”›V"
1560 LOCATE1,7:PRINT"VÑéò¢¨∂¿ ‘ﬁV"
1570 LOCATE1,8:PRINT"VÖèô£≠∑¡À’ﬂV"
1580 LOCATE1,9:PRINT"VÜêö§Æ∏¬Ã÷‡V"
1590 LOCATE1,10:PRINT"Váëõ•Øπ√Õ◊·V"
1600 LOCATE1,11:PRINT"Vàíú¶∞∫ƒŒÿ‚V"
1610 LOCATE1,12:PRINT"Vâìùß±ª≈œŸ„V"
1620 LOCATE1,13:PRINT"ZWWWWWWWWWW["
1630 LOCATE3,15:PRINT"Srt# End#"
1640 LOCATE1,17:PRINT"S"
1650 LOCATE3,17:PRINTSTRING$(4-LEN(HEX$(PS)),"0")+HEX$(PS)
1660 LOCATE8,17:PRINTSTRING$(4-LEN(HEX$(PS+7)),"0")+HEX$(PS+7)
1670 LOCATE1,19:PRINT"R"
1680 LOCATE3,19:PRINTSTRING$(4-LEN(HEX$(SI)),"0")+HEX$(SI)
1690 LOCATE8,19:PRINTSTRING$(4-LEN(HEX$(SI+799)),"0")+HEX$(SI+799)
1700 LOCATE1,21:PRINT"G"
1710 LOCATE3,21:PRINTSTRING$(4-LEN(HEX$(1)),"0")+HEX$(1)
1720 LOCATE8,21:PRINTSTRING$(4-LEN(HEX$(GL)),"0")+HEX$(GL)
1730 LOCATE14,2:PRINT"________________"
1740 LOCATE14,3:PRINT"________________"
1750 LOCATE14,4:PRINT"________________"
1760 LOCATE14,5:PRINT"________________"
1770 LOCATE14,6:PRINT"________________"
1780 LOCATE14,7:PRINT"________________"
1790 LOCATE14,8:PRINT"________________"
1800 LOCATE14,9:PRINT"________________"
1810 LOCATE14,10:PRINT"________________"
1820 LOCATE14,11:PRINT"________________"
1830 LOCATE14,12:PRINT"________________"
1840 LOCATE14,13:PRINT"________________"
1850 LOCATE14,14:PRINT"________________"
1860 LOCATE14,15:PRINT"________________"
1870 LOCATE14,16:PRINT"________________"
1880 LOCATE14,17:PRINT"________________"
1890 LOCATE13,19:PRINT"VÈVTglVCVErzVIVInv"
1900 LOCATE13,21:PRINT"VOVRldVPVSavVËVBck"
1910 CX=0:CY=0:TE=0
1920 VPOKE6924,15:VPOKE6925,112
1930 C=-1:OX=0:OY=0
1940 IFSS=8THENCL=7ELSECL=15
1950 FORI=PSTOPS+(SS-1)
1960 C=C+1
1970 IFTE=0THENGET#1,I:A$=F$:P$=BIN$(ASC(A$)):A=LEN(P$):Z=8-A:C$=STRING$(Z,"0"):B$=C$+P$
1980 IFC>15THENOX=8:OY=-16
1990 FORF=1TO8
2000 IFTE=0THENIFMID$(B$,F,1)="0"THENG=16ELSEG=228
2010 IFTE=1THENIFVPEEK((OX+13+F)+(OY+2+C)*32+6144)=16THENG=228ELSEG=16
2020 IFTE=2THENG=16
2030 VPOKE(OX+13+F)+(OY+2+C)*32+6144,G
2040 NEXT
2050 NEXT
2060 A$=INKEY$
2070 REM this will
2080 IFA$=CHR$(&H1C)ANDCX<CLTHENCX=CX+1:GOSUB2190
2090 IFA$=CHR$(&H1D)ANDCX>0THENCX=CX-1:GOSUB2190
2100 IFA$=CHR$(&H1E)ANDCY>0THENCY=CY-1:GOSUB2190
2110 IFA$=CHR$(&H1F)ANDCY<CLTHENCY=CY+1:GOSUB2190
2120 IFA$=CHR$(13)THENVPOKE6924,200:GOTO320
2130 IFA$=" "THENGOSUB2210
2140 IFA$="O"THENTE=0:GOTO1930
2150 IFA$="I"THENTE=1:GOTO1930
2160 IFA$="C"THENTE=2:GOTO1930
2170 IFA$="P"THENGOSUB2250
2180 GOTO2060
2190 VPOKE6924,15+(CY*8):VPOKE6925,112+(CX*8)
2200 RETURN
2210 G=VPEEK((CX+14)+(CY+2)*32+6144)
2220 IFG=16THENG=228ELSEG=16
2230 VPOKE(CX+14)+(CY+2)*32+6144,G
2240 RETURN
2250 C=-1:OX=0:OY=0
2260 FORI=PSTOPS+(SS-1)
2270 C=C+1
2280 'get #1,i :a$ = f$ :p$ = bin$(asc(a$)):a = len(p$) :z = 8-a :c$ = string$(z,"0") :b$ = c$+p$
2290 IFC>15THENOX=8:OY=-16
2300 B$="":M=128:N=0
2310 FORF=1TO8
2320 IFVPEEK((OX+13+F)+(OY+2+C)*32+6144)=16THENG$="0"ELSEG$="1"
2330 B$=B$+G$
2340 N=VAL(G$)*M+N:M=M/2
2350 NEXT
2360 A$=CHR$(N)
2370 LSETF$=A$:PUT#1,I
2380 VPOKE1024-SI+I,N
2390 NEXT
2400 RETURN
2410 CLS
2420 VPOKE6912,200:VPOKE6916,200:VPOKE6920,200:VPOKE6928,200
2430 LOCATE0,0:PRINT"        CHANGE GRAPH KIT        "
2440 LOCATE1,2:PRINT"XWWWWWWWWWWWWWWWWWWWY"
2450 LOCATE1,3:PRINT"VÄ ä î û ® ≤ º ∆ – ⁄V"
2460 LOCATE1,4:PRINT"V                   V"
2470 LOCATE1,5:PRINT"VÅ ã ï ü © ≥ Ω « — €V"
2480 LOCATE1,6:PRINT"V                   V"
2490 LOCATE1,7:PRINT"VÇ å ñ † ™ ¥ æ » “ ‹V"
2500 LOCATE1,8:PRINT"V                   V"
2510 LOCATE1,9:PRINT"VÉ ç ó ° ´ µ ø … ” ›V"
2520 LOCATE1,10:PRINT"V                   V"
2530 LOCATE1,11:PRINT"VÑ é ò ¢ ¨ ∂ ¿   ‘ ﬁV"
2540 LOCATE1,12:PRINT"V                   V"
2550 LOCATE1,13:PRINT"VÖ è ô £ ≠ ∑ ¡ À ’ ﬂV"
2560 LOCATE1,14:PRINT"V                   V"
2570 LOCATE1,15:PRINT"VÜ ê ö § Æ ∏ ¬ Ã ÷ ‡V"
2580 LOCATE1,16:PRINT"V                   V"
2590 LOCATE1,17:PRINT"Vá ë õ • Ø π √ Õ ◊ ·V"
2600 LOCATE1,18:PRINT"V                   V"
2610 LOCATE1,19:PRINT"Và í ú ¶ ∞ ∫ ƒ Œ ÿ ‚V"
2620 LOCATE1,20:PRINT"V                   V"
2630 LOCATE1,21:PRINT"Vâ ì ù ß ± ª ≈ œ Ÿ „V"
2640 LOCATE1,22:PRINT"ZWWWWWWWWWWWWWWWWWWW["
2650 LOCATE23,11:PRINT"VEV Back"
2660 IFINKEY$="E"THENGOTO320ELSEGOTO2660
2670 END
2680 DATA 4,4,36,100,252,96,32,0
2690 DATA 0,0,219,154,82,211,0,0
2700 DATA 231,195,165,24,24,165,195,231
2710 DATA 255,128,128,128,128,128,128,255
2720 DATA 255,0,0,0,0,0,0,255
2730 DATA 255,1,1,1,1,1,1,255
2740 DATA 0,126,126,126,126,126,126,0
2750 DATA 255,129,129,129,129,129,129,255 :PRINT:REM data with : after
2760 DATA 255,255,255,255,255,255,255,255 :REM this stay
2770 DATA 255,129,000,000,000,000,000,000,129,255,000,000,000,000,000,000,000,128,128,128,128,128,128,000,255,129,129,129,129,129,129,255
2780 ' Support routines only (not used by the main program)
2790 DATA 00,00,"00",00 :REM more highlight test
2800 DATA 00,00,00,00 :REM this stay
2810 DATA 00,00,00,##
2820 PRINT"## test"
2830 PRINT"however"##ALSOKEEP"this"(IF""AFTER
2840 C=127
2850 FORX=2TO11
2860 FORY=3TO12
2870 C=C+1:LOCATEX,Y:PRINTCHR$(C)
2880 NEXT
2890 NEXT
2900 END
2910 FORI=0TO255
2920 X=IMOD32:Y=I\32
2930 C=I
2940 IFC<32ORC=127THENC=32
2950 LOCATEX,Y:PRINTCHR$(C)
2960 LOCATEX,Y+10:PRINTCHR$(1)+CHR$(C)
2970 NEXT
2980 END
