10 ' Refactored with MSX Basic Dignified
20 'CHANGE GRAPH KIT
30 'Find and modify uncompressed art on games
40 '
50 'Conversion arguments: none
60 SCREEN 0:COLOR 15,1,1:WIDTH 40:KEY OFF
70 DEFINT A-Z
80 C1=1:C2=14:C3=2:C4=6
90 PRINT "Pick a Game":PRINT "without extension"
100 ?:?:?:FILES "*.bin"
110 ?:?:?:LINE INPUT "> ";GN$
120 CLS:SCREEN 1:WIDTH 32
130 ' {inicializacao}
140 LOCATE10,11:PRINT "INITIALIZING"
150 REM gn$="vestron6"
160 OPEN GN$+".bin" AS #1 LEN=1
170 FIELD #1,1 AS F$
180 GET#1,3:A$=F$:GET#1,2:B$=F$:GS=(ASC(A$)*256+ASC(B$))-65536!
190 GET#1,5:A$=F$:GET#1,4:B$=F$:GE=(ASC(A$)*256+ASC(B$))-65536!
200 GL=GE-GS
210 SI=&H1:MS=8:MR=800:HS=1
220 PS=SI:SX=16:SY=23:SS=8
230 CX=0:CY=0:TE=0
240 GOSUB 1070
250 FOR F=0 TO 7:READ A:VPOKE 1856+F,A:NEXT
260 FOR F=0 TO 7:READ A:VPOKE 1864+F,A:NEXT
270 FOR F=0 TO 7:READ A:VPOKE 1872+F,A:NEXT
280 FOR F=8 TO 31:READ A:VPOKE F,A:NEXT
290 FOR F=1824 TO 1831:READ A:VPOKE F,A:NEXT
300 FOR F=128 TO 135:READ A:VPOKE F,A:NEXT
310 FOR F=248 TO 255:READ A:VPOKE F,A:NEXT
320 FOR F=0 TO 31:READ A:VPOKE 14336+F,A:NEXT
330 ' {search_screen}
340 CLS
350 LOCATE0,0:PRINT "        CHANGE GRAPH KIT        "
360 LOCATE1,2:PRINT "XWWWWWWWWWWY"
370 LOCATE1,3:PRINT "VÄäîû®≤º∆–⁄V"
380 LOCATE1,4:PRINT "VÅãïü©≥Ω«—€V"
390 LOCATE1,5:PRINT "VÇåñ†™¥æ»“‹V"
400 LOCATE1,6:PRINT "VÉçó°´µø…”›V"
410 LOCATE1,7:PRINT "VÑéò¢¨∂¿ ‘ﬁV"
420 IF HS=1 THEN LOCATE 4,7:PRINT "FREEZE"
430 LOCATE1,8:PRINT "VÖèô£≠∑¡À’ﬂV"
440 LOCATE1,9:PRINT "VÜêö§Æ∏¬Ã÷‡V"
450 LOCATE1,10:PRINT "Váëõ•Øπ√Õ◊·V"
460 LOCATE1,11:PRINT "Vàíú¶∞∫ƒŒÿ‚V"
470 LOCATE1,12:PRINT "Vâìùß±ª≈œŸ„V"
480 LOCATE1,13:PRINT "ZWWWWWWWWWW["
490 LOCATE3,15:PRINT "Srt# End#"
500 LOCATE1,17:PRINT "S"
510 LOCATE3,17:PRINT STRING$(4-LEN(HEX$(PS)),"0")+HEX$(PS)
520 LOCATE8,17:PRINT STRING$(4-LEN(HEX$(PS+7)),"0")+HEX$(PS+7)
530 LOCATE1,19:PRINT "R"
540 LOCATE3,19:PRINT STRING$(4-LEN(HEX$(SI)),"0")+HEX$(SI)
550 LOCATE8,19:PRINT STRING$(4-LEN(HEX$(SI+799)),"0")+HEX$(SI+799)
560 LOCATE1,21:PRINT "G"
570 LOCATE3,21:PRINT STRING$(4-LEN(HEX$(1)),"0")+HEX$(1)
580 LOCATE8,21:PRINT STRING$(4-LEN(HEX$(GL)),"0")+HEX$(GL)
590 LOCATE13,2:PRINT "XWWWWWWWRWWWWWWWWY"
600 LOCATE13,3:PRINT "VMS  8x"+RIGHT$(STR$(MS),1)+"VEditing V"
610 LOCATE13,4:PRINT "VMR  "+RIGHT$(STR$(MR),3)+"V"+GN$+STRING$(8-LEN(GN$)," ")+"V"
620 LOCATE13,5:PRINT "ZWWWWWWWQWWWWWWWW["
630 LOCATE13,7:PRINT "VÍVMove VPVSave"
640 LOCATE13,9:PRINT "VÈVStep VMVSize"
650 LOCATE13,11:PRINT "VËVEdit VEVExplode"
660 LOCATE13,13:PRINT "VCVTogle Refrehs"
670 LOCATE13,15:PRINT "VQVPrev VWVNext"
680 LOCATE13,17:PRINT "VZV4x   VXV4x"
690 LOCATE13,19:PRINT "VAVSrtVSVMidVDVEnd"
700 LOCATE14,21:PRINT "ABBBBBBBBBBBBBBC"
710 AY=SY+(SS-2):AX=0
720 IF SY+(SS-2) > 101 THEN AX=8:AY=23+(SY+(SS-2))-103
730 IF SX+AX > 95 THEN AY=200
740 VPOKE 6912,SY:VPOKE 6913,SX
750 VPOKE 6916,AY:VPOKE 6917,AX+SX
760 VPOKE 6920,167:VPOKE 6921,126*SI/GL+113
770 VPOKE 6928,167:VPOKE 6929,(126*SI/GL)+113+(100800!/GL)
780 ' {read_keyboard_main}
790 A$ = INKEY$
800 IF A$ = CHR$(&H1C) AND SX+8 < 95 THEN SX=SX+8:PS=PS+80:GOSUB 1190
810 IF A$ = CHR$(&H1D) AND SX-8 > 15 THEN SX=SX-8:PS=PS-80:GOSUB 1190
820 IF A$ = CHR$(&H1E) AND SY-MS > 22 THEN SY=SY-MS:PS=PS-MS:GOSUB 1190
830 IF A$ = CHR$(&H1F) AND SY+MS < 103 THEN SY=SY+MS:PS=PS+MS:GOSUB 1190
840 IF A$ = "E" THEN GOTO 2550
850 IF A$ = "Q" THEN DP=PS-SI:SI=SI-MR:GOSUB 1380
860 IF A$ = "W" THEN DP=PS-SI:SI=SI+MR:GOSUB 1380
870 IF A$ = "Z" THEN DP=PS-SI:SI=SI-MR*4:GOSUB 1380
880 IF A$ = "X" THEN DP=PS-SI:SI=SI+MR*4:GOSUB 1380
890 IF A$ = "A" THEN DP=PS-SI:SI=&H1:GOSUB 1380
900 IF A$ = "D" THEN DP=PS-SI:SI=GL-800:GOSUB 1380
910 IF A$ = "S" THEN DP=PS-SI:SI=(GL/2)-400:GOSUB 1380
920 IF A$ = "L" THEN GOSUB 1380
930 IF A$ = " " THEN GOSUB 1510
940 IF A$ = "M" THEN GOSUB 1290
950 IF A$ = "P" THEN:SCREEN 0:WIDTH 40:CLOSE:PRINT GN$+" closed":PRINT:PRINT:PRINT:PRINT "ENTER to open another file ";:LINE INPUT A$:RUN
960 IF A$ = "C" THEN HS = ABS(HS-1):IF HS = 1 THEN LOCATE4,7:PRINT "FREEZE" ELSE LOCATE1,7:PRINT "VÑéò¢¨∂¿ ‘ﬁV":GOSUB 1380
970 IF A$ = CHR$(13) AND HS = 0 THEN GOTO 1560
980 IF A$ = "1" THEN C1=C1-1:GOSUB 1070
990 IF A$ = "2" THEN C1=C1+1:GOSUB 1070
1000 IF A$ = "3" THEN C2=C2-1:GOSUB 1070
1010 IF A$ = "4" THEN C2=C2+1:GOSUB 1070
1020 IF A$ = "5" THEN C3=C3-1:GOSUB 1070
1030 IF A$ = "6" THEN C3=C3+1:GOSUB 1070
1040 IF A$ = "7" THEN C1=C4-1:GOSUB 1070
1050 IF A$ = "8" THEN C1=C4+1:GOSUB 1070
1060 GOTO 780
1070 ' {set_color}
1080 C1 = ABS(C1 MOD 16+16) MOD 16:' use DEF FN
1090 C2 = ABS(C2 MOD 16+16) MOD 16:' same1
1100 C3 = ABS(C3 MOD 16+16) MOD 16:' same2
1110 C4 = ABS(C4 MOD 16+16) MOD 16:' same3
1120 COLOR C2,C1,C1
1130 VPOKE 8194,C4*16+C1:VPOKE 8195,C4*16+C1
1140 VPOKE 8192,C4*16+C3
1150 VPOKE 6914,0:VPOKE 6918,1:VPOKE 6922,2:VPOKE 6926,3:VPOKE 6930,2
1160 VPOKE 6915,C2:VPOKE 6919,C2:VPOKE 6923,C2:VPOKE 6927,C2
1170 FOR F=8208 TO 8220:VPOKE F,C3*16+C1:NEXT
1180 RETURN
1190 ' {move_scan_sprite}
1200 AY=SY+(SS-2):AX=0
1210 IF SY+(SS-2) > 101 THEN AX=8:AY=23+(SY+(SS-2))-103
1220 IF SX+AX > 95 THEN AY=200
1230 VPOKE 6912,SY:VPOKE 6913,SX
1240 VPOKE 6916,AY:VPOKE 6917,SX+AX
1250 LOCATE 3,17:PRINTSTRING$(4-LEN(HEX$(PS)),"0")+HEX$(PS):' use PRINT USING
1260 LOCATE 8,17:PRINTSTRING$(4-LEN(HEX$(PS+(SS-1))),"0")+HEX$(PS+(SS-1)):' same
1270 RETURN
1280 RETURN
1290 ' {change_sprite_size}
1300 IF SS = 8 THEN SS=32 ELSE SS=8
1310 AY=SY+(SS-2):AX=0
1320 IF SY+(SS-2) > 101 THEN AX=8:AY=23+(SY+(SS-2))-103
1330 IF SX+AX > 95 THEN AY=200
1340 VPOKE 6916,AY:VPOKE 6917,SX+AX
1350 LOCATE 3,17:PRINT STRING$(4-LEN(HEX$(PS)),"0")+HEX$(PS):' use PRINT USING
1360 LOCATE 8,17:PRINT STRING$(4-LEN(HEX$(PS+(SS-1))),"0")+HEX$(PS+(SS-1)):' same
1370 RETURN
1380 ' {update_memory_position}
1390 IF SI < &H1 THEN SI=&H1
1400 IF SI+800 > GL THEN SI=GL-800
1410 PS=SI+DP
1420 VPOKE 6920,167:VPOKE 6921,126*SI/GL+113
1430 VPOKE 6928,167:VPOKE 6929,(126*SI/GL)+113+(100800!/GL)
1440 LOCATE 3,17:PRINT STRING$(4-LEN(HEX$(PS)),"0")+HEX$(PS):' use PRINT USING
1450 LOCATE 8,17:PRINT STRING$(4-LEN(HEX$(PS+7)),"0")+HEX$(PS+7):' same
1460 LOCATE 3,19:PRINT STRING$(4-LEN(HEX$(SI)),"0")+HEX$(SI):' same
1470 LOCATE 8,19:PRINT STRING$(4-LEN(HEX$(SI+799)),"0")+HEX$(SI+799):' same
1480 'for f = si to si+799:vpoke 1024-si+f,peek(f) :next
1490 IF HS=0 THEN LOCATE5,2:PRINT "SCAN":FOR F=SI TO SI+799:GET #1,F:A$=F$:VPOKE 1024-SI+F,ASC(A$):NEXT:LOCATE5,2:PRINT "WWWW"
1500 RETURN
1510 ' {change_movement_step}
1520 IF MS=8 THEN MS=1 ELSE MS=8
1530 IF MR=800 THEN MR=400 ELSE MR=800
1540 LOCATE20,3:PRINT RIGHT$(STR$(MS),1):LOCATE18,4:PRINT RIGHT$(STR$(MR),3)
1550 RETURN
1560 ' {edit_screen}
1570 CLS
1580 VPOKE 6920,200:VPOKE 6928,200
1590 LOCATE0,0:PRINT "        CHANGE GRAPH KIT  read a      "
1600 LOCATE1,2:PRINT"XWWWWWWWWWWY"
1610 LOCATE1,3:PRINT"VÄäîû®≤º∆–⁄V"
1620 LOCATE1,4:PRINT"VÅãïü©≥Ω«—€V"
1630 LOCATE1,5:PRINT"VÇåñ†™¥æ»“‹V"
1640 LOCATE1,6:PRINT"VÉçó°´µø…”›V"
1650 LOCATE1,7:PRINT"VÑéò¢¨∂¿ ‘ﬁV"
1660 LOCATE1,8:PRINT"VÖèô£≠∑¡À’ﬂV"
1670 LOCATE1,9:PRINT"VÜêö§Æ∏¬Ã÷‡V"
1680 LOCATE1,10:PRINT"Váëõ•Øπ√Õ◊·V"
1690 LOCATE1,11:PRINT"Vàíú¶∞∫ƒŒÿ‚V"
1700 LOCATE1,12:PRINT"Vâìùß±ª≈œŸ„V"
1710 LOCATE1,13:PRINT"ZWWWWWWWWWW["
1720 LOCATE3,15:PRINT "Srt# End#"
1730 LOCATE1,17:PRINT "S"
1740 LOCATE3,17:PRINT STRING$(4-LEN(HEX$(PS)),"0")+HEX$(PS)
1750 LOCATE8,17:PRINT STRING$(4-LEN(HEX$(PS+7)),"0")+HEX$(PS+7)
1760 LOCATE1,19:PRINT "R"
1770 LOCATE3,19:PRINT STRING$(4-LEN(HEX$(SI)),"0")+HEX$(SI)
1780 LOCATE8,19:PRINT STRING$(4-LEN(HEX$(SI+799)),"0")+HEX$(SI+799)
1790 LOCATE1,21:PRINT "G"
1800 LOCATE3,21:PRINT STRING$(4-LEN(HEX$(1)),"0")+HEX$(1)
1810 LOCATE8,21:PRINT STRING$(4-LEN(HEX$(GL)),"0")+HEX$(GL)
1820 LOCATE14,2:PRINT "________________"
1830 LOCATE14,3:PRINT "________________"
1840 LOCATE14,4:PRINT "________________"
1850 LOCATE14,5:PRINT "________________"
1860 LOCATE14,6:PRINT "________________"
1870 LOCATE14,7:PRINT "________________"
1880 LOCATE14,8:PRINT "________________"
1890 LOCATE14,9:PRINT "________________"
1900 LOCATE14,10:PRINT "________________"
1910 LOCATE14,11:PRINT "________________"
1920 LOCATE14,12:PRINT "________________"
1930 LOCATE14,13:PRINT "________________"
1940 LOCATE14,14:PRINT "________________"
1950 LOCATE14,15:PRINT "________________"
1960 LOCATE14,16:PRINT "________________"
1970 LOCATE14,17:PRINT "________________"
1980 LOCATE13,19:PRINT"VÈVTglVCVErzVIVInv"
1990 LOCATE13,21:PRINT"VOVRldVPVSavVËVBck"
2000 CX = 0:CY = 0:TE = 0
2010 VPOKE 6924,15:VPOKE 6925,112
2020 ' {fill_edit_area}
2030 C=-1:OX=0:OY=0
2040 IF SS=8 THEN CL=7 ELSE CL=15
2050 FOR I=PS TO PS+(SS-1)
2060 C=C+1
2070 IF TE=0 THEN GET #1,I:A$=F$:P$=BIN$(ASC(A$)):A=LEN(P$):Z=8-A:C$=STRING$(Z,"0"):B$=C$+P$
2080 IF C>15 THEN OX=8:OY=-16
2090 FOR F=1 TO 8
2100 IF TE=0 THEN IF MID$(B$,F,1)="0" THEN G=16 ELSE G=228
2110 IF TE=1 THEN IF VPEEK((OX+13+F)+(OY+2+C)*32+6144)=16 THEN G=228 ELSE G=16
2120 IF TE=2 THEN G=16
2130 VPOKE(OX+13+F)+(OY+2+C)*32+6144,G
2140 NEXT
2150 NEXT
2160 ' {read_keyboard_edit}
2170 A$ = INKEY$
2180 REM this will
2190 IF A$ = CHR$(&H1C) AND CX < CL THEN CX = CX+1:GOSUB 2300
2200 IF A$ = CHR$(&H1D) AND CX > 0 THEN CX = CX-1:GOSUB 2300
2210 IF A$ = CHR$(&H1E) AND CY > 0 THEN CY = CY-1:GOSUB 2300
2220 IF A$ = CHR$(&H1F) AND CY < CL THEN CY = CY+1:GOSUB 2300
2230 IF A$ = CHR$(13) THEN VPOKE 6924,200:GOTO 330
2240 IF A$ = " " THEN GOSUB 2330
2250 IF A$ = "O" THEN TE = 0:GOTO 2020
2260 IF A$ = "I" THEN TE = 1:GOTO 2020
2270 IF A$ = "C" THEN TE = 2:GOTO 2020
2280 IF A$ = "P" THEN GOSUB 2380
2290 GOTO 2160
2300 ' {move_cursor}
2310 VPOKE 6924,15+(CY*8):VPOKE 6925,112+(CX*8)
2320 RETURN
2330 ' {change_bit}
2340 G = VPEEK((CX+14)+(CY+2)*32+6144)
2350 IF G = 16 THEN G = 228 ELSE G = 16
2360 VPOKE(CX+14)+(CY+2)*32+6144,G
2370 RETURN
2380 ' {save_drawing}
2390 C=-1:OX=0:OY=0
2400 FOR I=PS TO PS+(SS-1)
2410 C=C+1
2420 'get #1,i :a$ = f$ :p$ = bin$(asc(a$)):a = len(p$) :z = 8-a :c$ = string$(z,"0") :b$ = c$+p$
2430 IF C>15 THEN OX=8:OY=-16
2440 B$="":M=128:N=0
2450 FOR F=1 TO 8
2460 IF VPEEK ((OX+13+F)+(OY+2+C)*32+6144)=16 THEN G$ = "0" ELSE G$ = "1"
2470 B$=B$+G$
2480 N=VAL(G$)*M+N:M=M/2
2490 NEXT
2500 A$=CHR$(N)
2510 LSET F$=A$:PUT #1,I
2520 VPOKE 1024-SI+I,N
2530 NEXT
2540 RETURN
2550 ' {explode_screen}
2560 CLS
2570 VPOKE 6912,200:VPOKE 6916,200:VPOKE 6920,200:VPOKE 6928,200
2580 LOCATE0,0:PRINT "        CHANGE GRAPH KIT        "
2590 LOCATE1,2:PRINT "XWWWWWWWWWWWWWWWWWWWY"
2600 LOCATE1,3:PRINT "VÄ ä î û ® ≤ º ∆ – ⁄V"
2610 LOCATE1,4:PRINT "V                   V"
2620 LOCATE1,5:PRINT "VÅ ã ï ü © ≥ Ω « — €V"
2630 LOCATE1,6:PRINT "V                   V"
2640 LOCATE1,7:PRINT "VÇ å ñ † ™ ¥ æ » “ ‹V"
2650 LOCATE1,8:PRINT "V                   V"
2660 LOCATE1,9:PRINT "VÉ ç ó ° ´ µ ø … ” ›V"
2670 LOCATE1,10:PRINT "V                   V"
2680 LOCATE1,11:PRINT "VÑ é ò ¢ ¨ ∂ ¿   ‘ ﬁV"
2690 LOCATE1,12:PRINT "V                   V"
2700 LOCATE1,13:PRINT "VÖ è ô £ ≠ ∑ ¡ À ’ ﬂV"
2710 LOCATE1,14:PRINT "V                   V"
2720 LOCATE1,15:PRINT "VÜ ê ö § Æ ∏ ¬ Ã ÷ ‡V"
2730 LOCATE1,16:PRINT "V                   V"
2740 LOCATE1,17:PRINT "Vá ë õ • Ø π √ Õ ◊ ·V"
2750 LOCATE1,18:PRINT "V                   V"
2760 LOCATE1,19:PRINT "Và í ú ¶ ∞ ∫ ƒ Œ ÿ ‚V"
2770 LOCATE1,20:PRINT "V                   V"
2780 LOCATE1,21:PRINT "Vâ ì ù ß ± ª ≈ œ Ÿ „V"
2790 LOCATE1,22:PRINT "ZWWWWWWWWWWWWWWWWWWW["
2800 LOCATE23,11:PRINT "VEV Back"
2810 IF INKEY$ = "E" THEN GOTO 330 ELSE GOTO 2810
2820 END
2830 ' {character_shapes}
2840 DATA 4,4,36,100,252,96,32,0
2850 DATA 0,0,219,154,82,211,0,0
2860 DATA 231,195,165,24,24,165,195,231
2870 DATA 255,128,128,128,128,128,128,255
2880 DATA 255,0,0,0,0,0,0,255
2890 DATA 255,1,1,1,1,1,1,255
2900 DATA 0,126,126,126,126,126,126,0
2910 DATA 255,129,129,129,129,129,129,255 :PRINT:REM data with : after
2920 DATA 255,255,255,255,255,255,255,255 :REM this stay
2930 ' {sprite_shapes}
2940 DATA 255,129,000,000,000,000,000,000,129,255,000,000,000,000,000,000,000,128,128,128,128,128,128,000,255,129,129,129,129,129,129,255
2950 ' Support routines only (not used by the main program)
2960 ' {test_syntax_and_hashes_removal}
2970 DATA 00,00,"00",00 :REM more highlight test
2980 DATA 00,00,00,00 :REM this stay
2990 DATA 00,00,00,##
3000 PRINT "## test"
3010 PRINT "however" ## ALSO KEEP "this" (IF "" AFTER
3020 ' {cria_bloco_de_caracteres}
3030 C=127
3040 FOR X=2 TO 11
3050 FOR Y=3 TO 12
3060 C=C+1:LOCATEX,Y:PRINT CHR$(C)
3070 NEXT
3080 NEXT
3090 END
3100 ' {mapa_de_caracteres}
3110 FOR I=0 TO 255
3120 X=I MOD 32:Y=I\32
3130 C=I
3140 IF C<32 OR C=127 THEN C=32
3150 LOCATEX,Y:PRINT CHR$(C)
3160 LOCATEX,Y+10:PRINT CHR$(1)+CHR$(C)
3170 NEXT
3180 END
