10 ' Refactored with MSX Basic Dignified
20 'CHANGE GRAPH KIT
30 'Find and modify uncompressed art on games
40 '
50 'Conversion arguments: -sl -br
60 SCREEN 0:COLOR 15,1,1:WIDTH 40:KEY OFF
70 DEFINT A-Z
80 C1=1:C2=14:C3=2:C4=6
90 PRINT "Pick a Game":PRINT "without extension"
100 ?:?:?:FILES "*.bin"
110 ?:?:?:LINE INPUT "> ";GN$
120 CLS:SCREEN 1:WIDTH 32
130 '
140 ' {inicializacao}
150 LOCATE10,11:PRINT "INITIALIZING"
160 REM gn$="vestron6"
170 OPEN GN$+".bin" AS #1 LEN=1
180 FIELD #1,1 AS F$
190 GET#1,3:A$=F$:GET#1,2:B$=F$:GS=(ASC(A$)*256+ASC(B$))-65536!
200 GET#1,5:A$=F$:GET#1,4:B$=F$:GE=(ASC(A$)*256+ASC(B$))-65536!
210 GL=GE-GS
220 SI=&H1:MS=8:MR=800:HS=1
230 PS=SI:SX=16:SY=23:SS=8
240 CX=0:CY=0:TE=0
250 GOSUB 1110:' {set_color}
260 FOR F=0 TO 7:READ A:VPOKE 1856+F,A:NEXT
270 FOR F=0 TO 7:READ A:VPOKE 1864+F,A:NEXT
280 FOR F=0 TO 7:READ A:VPOKE 1872+F,A:NEXT
290 FOR F=8 TO 31:READ A:VPOKE F,A:NEXT
300 FOR F=1824 TO 1831:READ A:VPOKE F,A:NEXT
310 FOR F=128 TO 135:READ A:VPOKE F,A:NEXT
320 FOR F=248 TO 255:READ A:VPOKE F,A:NEXT
330 FOR F=0 TO 31:READ A:VPOKE 14336+F,A:NEXT
340 '
350 ' {search_screen}
360 CLS
370 LOCATE0,0:PRINT "        CHANGE GRAPH KIT        "
380 LOCATE1,2:PRINT "XWWWWWWWWWWY"
390 LOCATE1,3:PRINT "VÄäîû®≤º∆–⁄V"
400 LOCATE1,4:PRINT "VÅãïü©≥Ω«—€V"
410 LOCATE1,5:PRINT "VÇåñ†™¥æ»“‹V"
420 LOCATE1,6:PRINT "VÉçó°´µø…”›V"
430 LOCATE1,7:PRINT "VÑéò¢¨∂¿ ‘ﬁV"
440 IF HS=1 THEN LOCATE 4,7:PRINT "FREEZE"
450 LOCATE1,8:PRINT "VÖèô£≠∑¡À’ﬂV"
460 LOCATE1,9:PRINT "VÜêö§Æ∏¬Ã÷‡V"
470 LOCATE1,10:PRINT "Váëõ•Øπ√Õ◊·V"
480 LOCATE1,11:PRINT "Vàíú¶∞∫ƒŒÿ‚V"
490 LOCATE1,12:PRINT "Vâìùß±ª≈œŸ„V"
500 LOCATE1,13:PRINT "ZWWWWWWWWWW["
510 LOCATE3,15:PRINT "Srt# End#"
520 LOCATE1,17:PRINT "S"
530 LOCATE3,17:PRINT STRING$(4-LEN(HEX$(PS)),"0")+HEX$(PS)
540 LOCATE8,17:PRINT STRING$(4-LEN(HEX$(PS+7)),"0")+HEX$(PS+7)
550 LOCATE1,19:PRINT "R"
560 LOCATE3,19:PRINT STRING$(4-LEN(HEX$(SI)),"0")+HEX$(SI)
570 LOCATE8,19:PRINT STRING$(4-LEN(HEX$(SI+799)),"0")+HEX$(SI+799)
580 LOCATE1,21:PRINT "G"
590 LOCATE3,21:PRINT STRING$(4-LEN(HEX$(1)),"0")+HEX$(1)
600 LOCATE8,21:PRINT STRING$(4-LEN(HEX$(GL)),"0")+HEX$(GL)
610 LOCATE13,2:PRINT "XWWWWWWWRWWWWWWWWY"
620 LOCATE13,3:PRINT "VMS  8x"+RIGHT$(STR$(MS),1)+"VEditing V"
630 LOCATE13,4:PRINT "VMR  "+RIGHT$(STR$(MR),3)+"V"+GN$+STRING$(8-LEN(GN$)," ")+"V"
640 LOCATE13,5:PRINT "ZWWWWWWWQWWWWWWWW["
650 LOCATE13,7:PRINT "VÍVMove VPVSave"
660 LOCATE13,9:PRINT "VÈVStep VMVSize"
670 LOCATE13,11:PRINT "VËVEdit VEVExplode"
680 LOCATE13,13:PRINT "VCVTogle Refrehs"
690 LOCATE13,15:PRINT "VQVPrev VWVNext"
700 LOCATE13,17:PRINT "VZV4x   VXV4x"
710 LOCATE13,19:PRINT "VAVSrtVSVMidVDVEnd"
720 LOCATE14,21:PRINT "ABBBBBBBBBBBBBBC"
730 AY=SY+(SS-2):AX=0
740 IF SY+(SS-2) > 101 THEN AX=8:AY=23+(SY+(SS-2))-103
750 IF SX+AX > 95 THEN AY=200
760 VPOKE 6912,SY:VPOKE 6913,SX
770 VPOKE 6916,AY:VPOKE 6917,AX+SX
780 VPOKE 6920,167:VPOKE 6921,126*SI/GL+113
790 VPOKE 6928,167:VPOKE 6929,(126*SI/GL)+113+(100800!/GL)
800 '
810 ' {read_keyboard_main}
820 A$ = INKEY$
830 IF A$ = CHR$(&H1C) AND SX+8 < 95 THEN SX=SX+8:PS=PS+80:GOSUB 1240:' {move_scan_sprite}
840 IF A$ = CHR$(&H1D) AND SX-8 > 15 THEN SX=SX-8:PS=PS-80:GOSUB 1240:' {move_scan_sprite}
850 IF A$ = CHR$(&H1E) AND SY-MS > 22 THEN SY=SY-MS:PS=PS-MS:GOSUB 1240:' {move_scan_sprite}
860 IF A$ = CHR$(&H1F) AND SY+MS < 103 THEN SY=SY+MS:PS=PS+MS:GOSUB 1240:' {move_scan_sprite}
870 IF A$ = "E" THEN GOTO 2700:' {explode_screen}
880 IF A$ = "Q" THEN DP=PS-SI:SI=SI-MR:GOSUB 1450:' {update_memory_position}
890 IF A$ = "W" THEN DP=PS-SI:SI=SI+MR:GOSUB 1450:' {update_memory_position}
900 IF A$ = "Z" THEN DP=PS-SI:SI=SI-MR*4:GOSUB 1450:' {update_memory_position}
910 IF A$ = "X" THEN DP=PS-SI:SI=SI+MR*4:GOSUB 1450:' {update_memory_position}
920 IF A$ = "A" THEN DP=PS-SI:SI=&H1:GOSUB 1450:' {update_memory_position}
930 IF A$ = "D" THEN DP=PS-SI:SI=GL-800:GOSUB 1450:' {update_memory_position}
940 IF A$ = "S" THEN DP=PS-SI:SI=(GL/2)-400:GOSUB 1450:' {update_memory_position}
950 IF A$ = "L" THEN GOSUB 1450:' {update_memory_position}
960 IF A$ = " " THEN GOSUB 1590:' {change_movement_step}
970 IF A$ = "M" THEN GOSUB 1350:' {change_sprite_size}
980 IF A$ = "P" THEN:SCREEN 0:WIDTH 40:CLOSE:PRINT GN$+" closed":PRINT:PRINT:PRINT:PRINT "ENTER to open another file ";:LINE INPUT A$:RUN
990 IF A$ = "C" THEN HS = ABS(HS-1):IF HS = 1 THEN LOCATE4,7:PRINT "FREEZE" ELSE LOCATE1,7:PRINT "VÑéò¢¨∂¿ ‘ﬁV":GOSUB 1450:' {update_memory_position}
1000 IF A$ = CHR$(13) AND HS = 0 THEN GOTO 1650:' {edit_screen}
1010 IF A$ = "1" THEN C1=C1-1:GOSUB 1110:' {set_color}
1020 IF A$ = "2" THEN C1=C1+1:GOSUB 1110:' {set_color}
1030 IF A$ = "3" THEN C2=C2-1:GOSUB 1110:' {set_color}
1040 IF A$ = "4" THEN C2=C2+1:GOSUB 1110:' {set_color}
1050 IF A$ = "5" THEN C3=C3-1:GOSUB 1110:' {set_color}
1060 IF A$ = "6" THEN C3=C3+1:GOSUB 1110:' {set_color}
1070 IF A$ = "7" THEN C1=C4-1:GOSUB 1110:' {set_color}
1080 IF A$ = "8" THEN C1=C4+1:GOSUB 1110:' {set_color}
1090 GOTO 810:' {read_keyboard_main}
1100 '
1110 ' {set_color}
1120 C1 = ABS(C1 MOD 16+16) MOD 16:' use DEF FN
1130 C2 = ABS(C2 MOD 16+16) MOD 16:' same1
1140 C3 = ABS(C3 MOD 16+16) MOD 16:' same2
1150 C4 = ABS(C4 MOD 16+16) MOD 16:' same3
1160 COLOR C2,C1,C1
1170 VPOKE 8194,C4*16+C1:VPOKE 8195,C4*16+C1
1180 VPOKE 8192,C4*16+C3
1190 VPOKE 6914,0:VPOKE 6918,1:VPOKE 6922,2:VPOKE 6926,3:VPOKE 6930,2
1200 VPOKE 6915,C2:VPOKE 6919,C2:VPOKE 6923,C2:VPOKE 6927,C2
1210 FOR F=8208 TO 8220:VPOKE F,C3*16+C1:NEXT
1220 RETURN
1230 '
1240 ' {move_scan_sprite}
1250 AY=SY+(SS-2):AX=0
1260 IF SY+(SS-2) > 101 THEN AX=8:AY=23+(SY+(SS-2))-103
1270 IF SX+AX > 95 THEN AY=200
1280 VPOKE 6912,SY:VPOKE 6913,SX
1290 VPOKE 6916,AY:VPOKE 6917,SX+AX
1300 LOCATE 3,17:PRINTSTRING$(4-LEN(HEX$(PS)),"0")+HEX$(PS):' use PRINT USING
1310 LOCATE 8,17:PRINTSTRING$(4-LEN(HEX$(PS+(SS-1))),"0")+HEX$(PS+(SS-1)):' same
1320 RETURN
1330 RETURN
1340 '
1350 ' {change_sprite_size}
1360 IF SS = 8 THEN SS=32 ELSE SS=8
1370 AY=SY+(SS-2):AX=0
1380 IF SY+(SS-2) > 101 THEN AX=8:AY=23+(SY+(SS-2))-103
1390 IF SX+AX > 95 THEN AY=200
1400 VPOKE 6916,AY:VPOKE 6917,SX+AX
1410 LOCATE 3,17:PRINT STRING$(4-LEN(HEX$(PS)),"0")+HEX$(PS):' use PRINT USING
1420 LOCATE 8,17:PRINT STRING$(4-LEN(HEX$(PS+(SS-1))),"0")+HEX$(PS+(SS-1)):' same
1430 RETURN
1440 '
1450 ' {update_memory_position}
1460 IF SI < &H1 THEN SI=&H1
1470 IF SI+800 > GL THEN SI=GL-800
1480 PS=SI+DP
1490 VPOKE 6920,167:VPOKE 6921,126*SI/GL+113
1500 VPOKE 6928,167:VPOKE 6929,(126*SI/GL)+113+(100800!/GL)
1510 LOCATE 3,17:PRINT STRING$(4-LEN(HEX$(PS)),"0")+HEX$(PS):' use PRINT USING
1520 LOCATE 8,17:PRINT STRING$(4-LEN(HEX$(PS+7)),"0")+HEX$(PS+7):' same
1530 LOCATE 3,19:PRINT STRING$(4-LEN(HEX$(SI)),"0")+HEX$(SI):' same
1540 LOCATE 8,19:PRINT STRING$(4-LEN(HEX$(SI+799)),"0")+HEX$(SI+799):' same
1550 'for f = si to si+799:vpoke 1024-si+f,peek(f) :next
1560 IF HS=0 THEN LOCATE5,2:PRINT "SCAN":FOR F=SI TO SI+799:GET #1,F:A$=F$:VPOKE 1024-SI+F,ASC(A$):NEXT:LOCATE5,2:PRINT "WWWW"
1570 RETURN
1580 '
1590 ' {change_movement_step}
1600 IF MS=8 THEN MS=1 ELSE MS=8
1610 IF MR=800 THEN MR=400 ELSE MR=800
1620 LOCATE20,3:PRINT RIGHT$(STR$(MS),1):LOCATE18,4:PRINT RIGHT$(STR$(MR),3)
1630 RETURN
1640 '
1650 ' {edit_screen}
1660 CLS
1670 VPOKE 6920,200:VPOKE 6928,200
1680 LOCATE0,0:PRINT "        CHANGE GRAPH KIT  read a      "
1690 LOCATE1,2:PRINT"XWWWWWWWWWWY"
1700 LOCATE1,3:PRINT"VÄäîû®≤º∆–⁄V"
1710 LOCATE1,4:PRINT"VÅãïü©≥Ω«—€V"
1720 LOCATE1,5:PRINT"VÇåñ†™¥æ»“‹V"
1730 LOCATE1,6:PRINT"VÉçó°´µø…”›V"
1740 LOCATE1,7:PRINT"VÑéò¢¨∂¿ ‘ﬁV"
1750 LOCATE1,8:PRINT"VÖèô£≠∑¡À’ﬂV"
1760 LOCATE1,9:PRINT"VÜêö§Æ∏¬Ã÷‡V"
1770 LOCATE1,10:PRINT"Váëõ•Øπ√Õ◊·V"
1780 LOCATE1,11:PRINT"Vàíú¶∞∫ƒŒÿ‚V"
1790 LOCATE1,12:PRINT"Vâìùß±ª≈œŸ„V"
1800 LOCATE1,13:PRINT"ZWWWWWWWWWW["
1810 LOCATE3,15:PRINT "Srt# End#"
1820 LOCATE1,17:PRINT "S"
1830 LOCATE3,17:PRINT STRING$(4-LEN(HEX$(PS)),"0")+HEX$(PS)
1840 LOCATE8,17:PRINT STRING$(4-LEN(HEX$(PS+7)),"0")+HEX$(PS+7)
1850 LOCATE1,19:PRINT "R"
1860 LOCATE3,19:PRINT STRING$(4-LEN(HEX$(SI)),"0")+HEX$(SI)
1870 LOCATE8,19:PRINT STRING$(4-LEN(HEX$(SI+799)),"0")+HEX$(SI+799)
1880 LOCATE1,21:PRINT "G"
1890 LOCATE3,21:PRINT STRING$(4-LEN(HEX$(1)),"0")+HEX$(1)
1900 LOCATE8,21:PRINT STRING$(4-LEN(HEX$(GL)),"0")+HEX$(GL)
1910 LOCATE14,2:PRINT "________________"
1920 LOCATE14,3:PRINT "________________"
1930 LOCATE14,4:PRINT "________________"
1940 LOCATE14,5:PRINT "________________"
1950 LOCATE14,6:PRINT "________________"
1960 LOCATE14,7:PRINT "________________"
1970 LOCATE14,8:PRINT "________________"
1980 LOCATE14,9:PRINT "________________"
1990 LOCATE14,10:PRINT "________________"
2000 LOCATE14,11:PRINT "________________"
2010 LOCATE14,12:PRINT "________________"
2020 LOCATE14,13:PRINT "________________"
2030 LOCATE14,14:PRINT "________________"
2040 LOCATE14,15:PRINT "________________"
2050 LOCATE14,16:PRINT "________________"
2060 LOCATE14,17:PRINT "________________"
2070 LOCATE13,19:PRINT"VÈVTglVCVErzVIVInv"
2080 LOCATE13,21:PRINT"VOVRldVPVSavVËVBck"
2090 CX = 0:CY = 0:TE = 0
2100 VPOKE 6924,15:VPOKE 6925,112
2110 '
2120 ' {fill_edit_area}
2130 C=-1:OX=0:OY=0
2140 IF SS=8 THEN CL=7 ELSE CL=15
2150 FOR I=PS TO PS+(SS-1)
2160 C=C+1
2170 IF TE=0 THEN GET #1,I:A$=F$:P$=BIN$(ASC(A$)):A=LEN(P$):Z=8-A:C$=STRING$(Z,"0"):B$=C$+P$
2180 IF C>15 THEN OX=8:OY=-16
2190 FOR F=1 TO 8
2200 IF TE=0 THEN IF MID$(B$,F,1)="0" THEN G=16 ELSE G=228
2210 IF TE=1 THEN IF VPEEK((OX+13+F)+(OY+2+C)*32+6144)=16 THEN G=228 ELSE G=16
2220 IF TE=2 THEN G=16
2230 VPOKE(OX+13+F)+(OY+2+C)*32+6144,G
2240 NEXT
2250 NEXT
2260 '
2270 ' {read_keyboard_edit}
2280 A$ = INKEY$
2290 REM this will
2300 IF A$ = CHR$(&H1C) AND CX < CL THEN CX = CX+1:GOSUB 2420:' {move_cursor}
2310 IF A$ = CHR$(&H1D) AND CX > 0 THEN CX = CX-1:GOSUB 2420:' {move_cursor}
2320 IF A$ = CHR$(&H1E) AND CY > 0 THEN CY = CY-1:GOSUB 2420:' {move_cursor}
2330 IF A$ = CHR$(&H1F) AND CY < CL THEN CY = CY+1:GOSUB 2420:' {move_cursor}
2340 IF A$ = CHR$(13) THEN VPOKE 6924,200:GOTO 350:' {search_screen}
2350 IF A$ = " " THEN GOSUB 2460:' {change_bit}
2360 IF A$ = "O" THEN TE = 0:GOTO 2120:' {fill_edit_area}
2370 IF A$ = "I" THEN TE = 1:GOTO 2120:' {fill_edit_area}
2380 IF A$ = "C" THEN TE = 2:GOTO 2120:' {fill_edit_area}
2390 IF A$ = "P" THEN GOSUB 2520:' {save_drawing}
2400 GOTO 2270:' {read_keyboard_edit}
2410 '
2420 ' {move_cursor}
2430 VPOKE 6924,15+(CY*8):VPOKE 6925,112+(CX*8)
2440 RETURN
2450 '
2460 ' {change_bit}
2470 G = VPEEK((CX+14)+(CY+2)*32+6144)
2480 IF G = 16 THEN G = 228 ELSE G = 16
2490 VPOKE(CX+14)+(CY+2)*32+6144,G
2500 RETURN
2510 '
2520 ' {save_drawing}
2530 C=-1:OX=0:OY=0
2540 FOR I=PS TO PS+(SS-1)
2550 C=C+1
2560 'get #1,i :a$ = f$ :p$ = bin$(asc(a$)):a = len(p$) :z = 8-a :c$ = string$(z,"0") :b$ = c$+p$
2570 IF C>15 THEN OX=8:OY=-16
2580 B$="":M=128:N=0
2590 FOR F=1 TO 8
2600 IF VPEEK ((OX+13+F)+(OY+2+C)*32+6144)=16 THEN G$ = "0" ELSE G$ = "1"
2610 B$=B$+G$
2620 N=VAL(G$)*M+N:M=M/2
2630 NEXT
2640 A$=CHR$(N)
2650 LSET F$=A$:PUT #1,I
2660 VPOKE 1024-SI+I,N
2670 NEXT
2680 RETURN
2690 '
2700 ' {explode_screen}
2710 CLS
2720 VPOKE 6912,200:VPOKE 6916,200:VPOKE 6920,200:VPOKE 6928,200
2730 LOCATE0,0:PRINT "        CHANGE GRAPH KIT        "
2740 LOCATE1,2:PRINT "XWWWWWWWWWWWWWWWWWWWY"
2750 LOCATE1,3:PRINT "VÄ ä î û ® ≤ º ∆ – ⁄V"
2760 LOCATE1,4:PRINT "V                   V"
2770 LOCATE1,5:PRINT "VÅ ã ï ü © ≥ Ω « — €V"
2780 LOCATE1,6:PRINT "V                   V"
2790 LOCATE1,7:PRINT "VÇ å ñ † ™ ¥ æ » “ ‹V"
2800 LOCATE1,8:PRINT "V                   V"
2810 LOCATE1,9:PRINT "VÉ ç ó ° ´ µ ø … ” ›V"
2820 LOCATE1,10:PRINT "V                   V"
2830 LOCATE1,11:PRINT "VÑ é ò ¢ ¨ ∂ ¿   ‘ ﬁV"
2840 LOCATE1,12:PRINT "V                   V"
2850 LOCATE1,13:PRINT "VÖ è ô £ ≠ ∑ ¡ À ’ ﬂV"
2860 LOCATE1,14:PRINT "V                   V"
2870 LOCATE1,15:PRINT "VÜ ê ö § Æ ∏ ¬ Ã ÷ ‡V"
2880 LOCATE1,16:PRINT "V                   V"
2890 LOCATE1,17:PRINT "Vá ë õ • Ø π √ Õ ◊ ·V"
2900 LOCATE1,18:PRINT "V                   V"
2910 LOCATE1,19:PRINT "Và í ú ¶ ∞ ∫ ƒ Œ ÿ ‚V"
2920 LOCATE1,20:PRINT "V                   V"
2930 LOCATE1,21:PRINT "Vâ ì ù ß ± ª ≈ œ Ÿ „V"
2940 LOCATE1,22:PRINT "ZWWWWWWWWWWWWWWWWWWW["
2950 LOCATE23,11:PRINT "VEV Back"
2960 IF INKEY$ = "E" THEN GOTO 350 ELSE GOTO 2960:' {search_screen} {SELF}
2970 END
2980 '
2990 ' {character_shapes}
3000 DATA 4,4,36,100,252,96,32,0
3010 DATA 0,0,219,154,82,211,0,0
3020 DATA 231,195,165,24,24,165,195,231
3030 DATA 255,128,128,128,128,128,128,255
3040 DATA 255,0,0,0,0,0,0,255
3050 DATA 255,1,1,1,1,1,1,255
3060 DATA 0,126,126,126,126,126,126,0
3070 DATA 255,129,129,129,129,129,129,255 :PRINT:REM data with : after
3080 DATA 255,255,255,255,255,255,255,255 :REM this stay
3090 '
3100 ' {sprite_shapes}
3110 DATA 255,129,000,000,000,000,000,000,129,255,000,000,000,000,000,000,000,128,128,128,128,128,128,000,255,129,129,129,129,129,129,255
3120 ' Support routines only (not used by the main program)
3130 '
3140 ' {test_syntax_and_hashes_removal}
3150 DATA 00,00,"00",00 :REM more highlight test
3160 DATA 00,00,00,00 :REM this stay
3170 DATA 00,00,00,##
3180 PRINT "## test"
3190 PRINT "however" ## ALSO KEEP "this" (IF "" AFTER
3200 '
3210 ' {cria_bloco_de_caracteres}
3220 C=127
3230 FOR X=2 TO 11
3240 FOR Y=3 TO 12
3250 C=C+1:LOCATEX,Y:PRINT CHR$(C)
3260 NEXT
3270 NEXT
3280 END
3290 '
3300 ' {mapa_de_caracteres}
3310 FOR I=0 TO 255
3320 X=I MOD 32:Y=I\32
3330 C=I
3340 IF C<32 OR C=127 THEN C=32
3350 LOCATEX,Y:PRINT CHR$(C)
3360 LOCATEX,Y+10:PRINT CHR$(1)+CHR$(C)
3370 NEXT
3380 END
